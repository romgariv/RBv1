running src/merge.py
Beginning import_data from file(s): input/officer-reference.csv.gz
Data shape = 122636 rows, 22 columns
Beginning fill_data() on ref_df for ['first_name_NS', 'last_name_NS', 'birth_year', 'appointed_date', 'star', 'suffix_name', 'middle_initial', 'middle_initial2', 'race', 'gender', 'current_unit', 'resignation_date'] columns by NUID, with initial rows = 122636
fill_data() complete, final rows = 50159
Adding column by exec("self._data["current_age_p1"] = 2018 - self._data["birth_year"]")
Adding column by exec("self._data["current_age_m1"] = 2017 - self._data["birth_year"]")
Beginning import_data from file(s): input/roster__2018-03.csv.gz
Data shape = 14088 rows, 20 columns
1930 rows dropped by filter query: is_sworn_officer == "Y"
Adding column by exec("self._data["current_age_p1"] = self._data["current_age"]")
Adding column by exec("self._data["current_age_m1"] = self._data["current_age"]")
Adding column by exec("self._data["star"]=self._data["current_star"]")

Merge Report:
11101 Total Merged Pairs: 34.21% of ref and 91.31% of sup Merged.
21346 Unmerged in ref. 65.79% Unmerged.
1057 Unmerged in sup. 8.69% Unmerged.

star-first_name_NS-last_name_NS-appointed_date-current_age_m1-middle_initial-gender-race-current_unit                    6409
star-first_name_NS-last_name_NS-appointed_date-current_age_m1-gender-race-current_unit                                   1487
star-first_name_NS-last_name_NS-appointed_date-current_age_m1-middle_initial-gender-race                                  885
star-first_name_NS-last_name_NS-appointed_date-current_age_p1-middle_initial-gender-race-current_unit                     560
first_name_NS-last_name_NS-appointed_date-current_age_m1-middle_initial-gender-race-current_unit                          249
                                                                                                                         ... 
star-first_name_NS-last_name_NS-appointed_date-current_age_m1-middle_initial-race-current_unit                              1
star-first_name_NS-last_name_NS-appointed_date-current_age_m1-middle_initial-middle_initial2-gender-race-current_unit       1
star-first_name_NS-last_name_NS-appointed_date-current_age_p1-gender-race-suffix_name                                       1
star-first_name_NS-last_name_NS-appointed_date-current_age_p1-middle_initial-gender-current_unit                            1
first_name_NS-last_name_NS-middle_initial-current_age_p1-race-gender                                                        1
Name: matched_on, Length: 66, dtype: int64
Writing data with 134794 rows to output/officer-reference.csv.gz with 33504 unique UIDs
