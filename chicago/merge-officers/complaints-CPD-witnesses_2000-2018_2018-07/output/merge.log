running src/merge.py
Beginning import_data from file(s): input/officer-reference.csv.gz
Data shape = 313211 rows, 45 columns
Adding column by exec("self._data["current_rank_temp"]=self._data["current_rank"]")
Adding column by exec("self._data["current_age1"]=self._data["current_age"]")
Adding column by exec("self._data["current_age2"]=self._data["current_age"]")
Adding column by exec("self._data["current_age3"]=self._data["current_age"]")
Beginning import_data from file(s): input/complaints-CPD-witnesses_2000-2018_2018-07.csv.gz
Data shape = 25390 rows, 25 columns
943 rows dropped by filter query: likely_sworn_officer==1
Unique data size = 10461
Adding column by exec("self._data["current_rank_temp"]=self._data["rank"]")
Adding column by exec("self._data["current_age1"]=2018 - self._data["birth_year"]")
Adding column by exec("self._data["current_age2"]=2017 - self._data["birth_year"]")
Adding column by exec("self._data["current_age3"]=2016 - self._data["birth_year"]")
Merge Report:
9928 Total Merged Pairs: 29.52% of ref and 99.94% of sup Merged.
23707 Unmerged in ref. 70.48% Unmerged.
6 Unmerged in sup. 0.06% Unmerged.

birth_year-first_name_NS-last_name_NS-middle_initial-gender-race-current_rank_temp                    6492
birth_year-first_name_NS-last_name_NS-gender-race-current_rank_temp                                   1509
birth_year-first_name_NS-last_name_NS-middle_initial-gender-race-rank                                  953
birth_year-first_name_NS-last_name_NS-middle_initial-gender-race-suffix_name-current_rank_temp         198
birth_year-first_name_NS-last_name_NS-gender-race-rank                                                 167
birth_year-first_name_NS-last_name_NS-gender-race-suffix_name-current_rank_temp                        146
birth_year-first_name_NS-last_name_NS-middle_initial-gender-race                                       127
birth_year-first_name_NS-last_name_NS-gender-race                                                       85
current_age2-first_name_NS-last_name_NS-middle_initial-gender-race                                      75
birth_year-first_name_NS-last_name_NS-middle_initial-gender-race-suffix_name-rank                       40
current_age2-first_name_NS-last_name_NS-gender-race                                                     33
birth_year-first_name_NS-last_name_NS-gender-race-suffix_name-rank                                      16
current_age3-first_name_NS-last_name_NS-middle_initial-gender-race                                      16
birth_year-first_name_NS-last_name_NS-middle_initial-gender-current_rank_temp                            9
gender == "FEMALE" : first_name_NS-birth_year-middle_initial-race                                        8
current_age3-first_name_NS-last_name_NS-gender-race                                                      7
current_age1-first_name_NS-last_name_NS-middle_initial-gender-race                                       5
current_age2-first_name_NS-last_name_NS-middle_initial-gender                                            4
birth_year-first_name_NS-last_name_NS-gender-current_rank_temp                                           4
birth_year-first_name_NS-last_name_NS-middle_initial-middle_initial2-gender-race-current_rank_temp       4
birth_year-first_name_NS-last_name_NS-middle_initial-gender-race-current_rank_temp-current_unit          4
current_age1-first_name_NS-last_name_NS-gender-race                                                      3
current_age2-first_name_NS-last_name_NS-gender-race-suffix_name                                          3
gender == "FEMALE" : first_name_NS-birth_year-race                                                       2
birth_year-first_name_NS-F4LN-middle_initial-gender-race-current_rank_temp                               2
birth_year-first_name_NS-F4LN-gender-race-current_rank_temp                                              2
birth_year-first_name_NS-last_name_NS-middle_initial-gender-race-suffix_name                             2
birth_year-first_name_NS-last_name_NS-middle_initial-gender-race-current_unit                            2
current_age2-first_name_NS-last_name_NS-gender                                                           2
current_age3-first_name_NS-last_name_NS-middle_initial-gender                                            1
birth_year-first_name_NS-last_name_NS-gender-race-current_unit                                           1
birth_year-first_name_NS-last_name_NS-middle_initial-gender-suffix_name-current_rank_temp                1
birth_year-first_name_NS-last_name_NS-gender-race-current_rank_temp-current_unit                         1
birth_year-first_name_NS-last_name_NS-middle_initial-race                                                1
birth_year-first_name_NS-last_name_NS-gender-race-suffix_name                                            1
current_age2-first_name_NS-last_name_NS-middle_initial-gender-race-suffix_name                           1
birth_year-first_name_NS-last_name_NS-middle_initial-gender                                              1
Name: matched_on, dtype: int64
Writing data with 323666 rows to output/officer-reference.csv.gz with 33635 unique UIDs
