running src/format.py
Beginning import_data from file(s): input/accused_export.xlsx
Data shape = 279961 rows, 29 columns
LOG_NO -> cr_id , OFFICER_FIRST_NAME -> first_name , OFFICER_LAST_NAME -> last_name , MIDDLE_INITIAL -> middle_initial , RACE_CODE_CD -> race , SEX_CODE_CD -> gender , BIRTH_YEAR -> birth_year , STAR_NO -> star , EMPLOYEE_NO -> employee_id , EMPLOYEE_POSITION -> rank , ALLEGATION_CATEGORY -> alleg_category , ALLEGATION_CATEGORY_CD -> alleg_category_code , INV_CURRENT_CATEGORY -> inv_current_category , INV_CURRENT_CATEGORY_CD -> inv_current_category_code , EMPLOYEE_POSITION_1 -> rank2 , EMPLOYEE_ASSIGN_UNIT -> unit , EMPLOYEE_DETAIL_UNIT -> unit_detail , ACCUSED_ARRESTED -> accused_arrested , EMPLOYEE_ON_DUTY -> on_duty , INJURY_CONDITION -> injury , FINDING_CODE -> final_finding , FINDING_NARRATIVE -> finding_narrative , ACCUSATION_ID -> accusation_id , PENALTY_ID -> penalty_id , PENALTY_CODE -> penalty_code , NO_OF_DAYS -> penalty_duration , NARRATIVE -> penalty_narrative , IAD_OPS -> IAD_OPS , CR_REQUIRED -> cr_required
ROWID column inserted
Keeping column(s): ['ROWID', 'cr_id', 'first_name', 'last_name', 'middle_initial', 'race', 'gender', 'birth_year', 'star', 'employee_id', 'rank', 'alleg_category', 'alleg_category_code', 'inv_current_category', 'inv_current_category_code', 'unit', 'unit_detail', 'accused_arrested', 'on_duty', 'injury', 'final_finding', 'finding_narrative', 'accusation_id', 'penalty_id', 'penalty_code', 'penalty_duration', 'penalty_narrative', 'IAD_OPS', 'cr_required']
Column 'ROWID' was not cleaned.
Column 'cr_id' was not cleaned.
Column 'race' cleaned as race using GeneralCleaners.
[nan, 'U'] values not in race_types.yaml file. 48849 cases replaced with 'nan'
Column 'gender' cleaned as gender using GeneralCleaners.
[nan] values not in gender_types.yaml file. 48770 cases replaced with 'nan'
Column 'birth_year' cleaned as int using GeneralCleaners.
Column 'star' cleaned as star using GeneralCleaners.
Column 'employee_id' was not cleaned.
Column 'rank' was not cleaned.
Column 'alleg_category' was not cleaned.
Column 'alleg_category_code' was not cleaned.
Column 'inv_current_category' was not cleaned.
Column 'inv_current_category_code' was not cleaned.
Column 'unit' cleaned as int using GeneralCleaners.
Column 'unit_detail' was not cleaned.
Column 'accused_arrested' was not cleaned.
Column 'on_duty' was not cleaned.
Column 'injury' was not cleaned.
Column 'final_finding' was not cleaned.
Column 'finding_narrative' was not cleaned.
Column 'accusation_id' was not cleaned.
Column 'penalty_id' was not cleaned.
Column 'penalty_code' was not cleaned.
Column 'penalty_duration' was not cleaned.
Column 'penalty_narrative' was not cleaned.
Column 'IAD_OPS' was not cleaned.
Column 'cr_required' was not cleaned.
Column(s) '('first_name', 'last_name', 'middle_initial')' cleaned as name(s) using NameCleaners.
Columns dropped due to all NA values: ('human_name', 'second_name', 'full_name', 'middle_name')
1275 resolved conflicts. 6 unresolved conflicts
Total rows: 279961
Unique id + conflict rows: 17107
Conflict rows: 1281
Resolved conflcit UID count: 1275
Total unique ids: 17101.0

15730 officers in file
Added "likely_sworn_officer" column base on rank
Writing data with 279961 rows to output/complaints-accused_2000-2018_2018-07.csv.gz with 17101 unique UIDs
